<app-new-consultation-expansion-section [title]="'ambulatoria.paciente.violence-situations.dialog.implemented-actions.TITLE' | translate" icon="cancel">

    <form [formGroup]="form">
        <mat-radio-group class="basic-options"
            formControlName="articulation">
            <mat-radio-button *ngFor="let opt of articulations" [value]="opt">
                {{opt}}
            </mat-radio-button>
        </mat-radio-group>

        <div *ngIf="articulation === articulationEnum.IN" class="aside column">
            <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.SUBTITLE_1' | translate}}</span>

			<mat-radio-group class="basic-options"
            	formControlName="healthSystemArticulation">
				<mat-radio-button *ngFor="let opt of basicOptions" [value]="opt.value">
					{{opt.text}}
				</mat-radio-button>
        	</mat-radio-group>

            <mat-form-field appearance="outline" *ngIf="healthSystemArticulation">
				<mat-label>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_1' | translate}}</mat-label>
				<mat-select id="violence-situation-area-label" multiple
					formControlName="area"
					placeholder="{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_1' | translate}}">
					<mat-option *ngFor="let opt of areas"
						[value]="opt">
						{{opt}}
					</mat-option>
				</mat-select>
				<button id="clear_violence-situation-area" type="button" mat-button
					*ngIf="form.value.area?.length" matSuffix color="warn" mat-icon-button
					(click)="form.controls.area.reset(); $event.stopPropagation()">
					<mat-icon>close</mat-icon>
				</button>
				<mat-error *ngIf="hasError(form, 'required', 'area')" [translate]="'forms.REQUIRED'"></mat-error>
			</mat-form-field>

            <div *ngIf="area?.includes(areaEnum.OTHER)" class="column">
                <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_2' | translate}}</span>
                <mat-form-field appearance="outline">
                    <textarea matInput type="text" id="violence-situation-other-area" formControlName="otherArea"
                        placeholder="{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_2' | translate }}" required>
                    </textarea>
                    <mat-error *ngIf="hasError(form, 'required', 'otherArea')" [translate]="'forms.REQUIRED'"></mat-error>
                </mat-form-field>
            </div>

            <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.SUBTITLE_2' | translate}}</span>

            <mat-radio-group class="basic-options"
                formControlName="articulationEstablishment">
                <mat-radio-button *ngFor="let opt of basicOptions" [value]="opt.value">
                    {{opt.text}}
                </mat-radio-button>
            </mat-radio-group>
            
            <mat-form-field appearance="outline" *ngIf="articulationEstablishment">
				<mat-label>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_3' | translate}}</mat-label>
				<mat-select id="violence-situation-establishment" multiple
					formControlName="articulationEstablishmentList"
					placeholder="{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_3' | translate}}">
					<mat-option *ngFor="let opt of establishments"
						[value]="opt">
						{{opt}}
					</mat-option>
				</mat-select>
				<button id="clear_violence-situation-establishments" type="button" mat-button
					*ngIf="form.value.articulationEstablishmentList?.length" matSuffix color="warn" mat-icon-button
					(click)="form.controls.articulationEstablishmentList.reset(); $event.stopPropagation()">
					<mat-icon>close</mat-icon>
				</button>
				<mat-error *ngIf="hasError(form, 'required', 'articulationEstablishmentList')" [translate]="'forms.REQUIRED'"></mat-error>
			</mat-form-field>

            <div *ngIf="articulationEstablishmentList?.includes(establishmentsEnum.OTHER)" class="column">
                <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_4' | translate}}</span>
                <mat-form-field appearance="outline">
                    <textarea matInput type="text" id="violence-situation-other-establishment" formControlName="otherArticulationEstablishment"
                        placeholder="{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_4' | translate }}" required>
                    </textarea>
                    <mat-error *ngIf="hasError(form, 'required', 'otherArticulationEstablishment')" [translate]="'forms.REQUIRED'"></mat-error>
                </mat-form-field>
            </div>

            <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_5' | translate}}</span>
            <mat-radio-group class="basic-options"
                formControlName="internmentIndication">
                <mat-radio-button *ngFor="let opt of intermentIndicationOptions" [value]="opt">
                    {{opt}}
                </mat-radio-button>
            </mat-radio-group>

        </div>

        <div *ngIf="articulation === articulationEnum.OUT" class="aside column">
            <mat-checkbox (click)="setDevice(devicesEnum.MUNICIPAL_DEVICES)">{{ devicesEnum.MUNICIPAL_DEVICES }}</mat-checkbox>

            <div *ngIf="devices.includes(devicesEnum.MUNICIPAL_DEVICES)" class="aside column">
                <mat-checkbox *ngFor="let mdev of municipalDevicesList" (click)="setMunicipalDevices(mdev)">{{ mdev }}</mat-checkbox>
            </div>

            <mat-checkbox (click)="setDevice(devicesEnum.PROVINCIAL_DEVICES)">{{ devicesEnum.PROVINCIAL_DEVICES }}</mat-checkbox>

            <div *ngIf="devices.includes(devicesEnum.PROVINCIAL_DEVICES)" class="aside column">
                <mat-checkbox *ngFor="let pdev of provincialDevicesList" (click)="setProvincialDevices(pdev)">{{ pdev }}</mat-checkbox>
            </div>

            <mat-checkbox (click)="setDevice(devicesEnum.NATIONAL_DEVICES)">{{ devicesEnum.NATIONAL_DEVICES }}</mat-checkbox>

            <div *ngIf="devices.includes(devicesEnum.NATIONAL_DEVICES)" class="aside column">
                <mat-checkbox *ngFor="let ndev of nationalDevicesList" (click)="setNationalDevices(ndev)">{{ ndev }}</mat-checkbox>
            </div>

            <mat-checkbox (click)="setDevice(devicesEnum.SOCIAL_ORGANIZATION)">{{ devicesEnum.SOCIAL_ORGANIZATION }}</mat-checkbox>
        </div>

        <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_6' | translate}}</span>

        <mat-radio-group class="basic-options"
            formControlName="personComplaint">
            <mat-radio-button *ngFor="let opt of basicOptions" [value]="opt.value">
                {{opt.text}}
            </mat-radio-button>
        </mat-radio-group>
        
        <div *ngIf="personComplaint">
            <mat-form-field appearance="outline">
				<mat-label>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_7' | translate}}</mat-label>
				<mat-select id="violence-situation-establishment" multiple
					formControlName="agencyComplaint"
					placeholder="{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_7' | translate}}">
					<mat-option *ngFor="let opt of organizations"
						[value]="opt">
						{{opt}}
					</mat-option>
				</mat-select>
				<button id="clear_violence-situation-organizations" type="button" mat-button
					*ngIf="form.value.agencyComplaint?.length" matSuffix color="warn" mat-icon-button
					(click)="form.controls.agencyComplaint.reset(); $event.stopPropagation()">
					<mat-icon>close</mat-icon>
				</button>
				<mat-error *ngIf="hasError(form, 'required', 'agencyComplaint')" [translate]="'forms.REQUIRED'"></mat-error>
			</mat-form-field>
        </div>

        <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_8' | translate}}</span>

        <mat-radio-group class="basic-options"
            formControlName="isInstitutionComplaint">
            <mat-radio-button *ngFor="let opt of basicOptions" [value]="opt.value">
                {{opt.text}}
            </mat-radio-button>
        </mat-radio-group>

        <div *ngIf="isInstitutionComplaint" class="aside column">
            <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_9' | translate}}</span>

            <mat-checkbox *ngFor="let opt of complaints" (click)="setComplaints(opt)">
                {{opt}}
            </mat-checkbox>

            <mat-form-field appearance="outline">
				<mat-label>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_10' | translate}}</mat-label>
				<mat-select id="violence-situation-organizations-extended" multiple
					formControlName="institutionComplaintsOrganizations"
					placeholder="{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_10' | translate}}">
					<mat-option *ngFor="let opt of organizationsExtended"
						[value]="opt">
						{{opt}}
					</mat-option>
				</mat-select>
				<button id="clear_violence-situation-organizations-extended" type="button" mat-button
					*ngIf="form.value.institutionComplaintsOrganizations?.length" matSuffix color="warn" mat-icon-button
					(click)="form.controls.institutionComplaintsOrganizations.reset(); $event.stopPropagation()">
					<mat-icon>close</mat-icon>
				</button>
				<mat-error *ngIf="hasError(form, 'required', 'institutionComplaintsOrganizations')" [translate]="'forms.REQUIRED'"></mat-error>
			</mat-form-field>

            <div *ngIf="institutionComplaintsOrganizations?.includes(organizationsExtendedEnum.OTHER)" class="column">
                <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_11' | translate}}</span>
                <mat-form-field appearance="outline">
                    <textarea matInput type="text" id="violence-situation-name-autority" formControlName="autorityName"
                        placeholder="{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_11' | translate }}" required>
                    </textarea>
                    <mat-error *ngIf="hasError(form, 'required', 'autorityName')" [translate]="'forms.REQUIRED'"></mat-error>
                </mat-form-field>
            </div>
        </div>

        <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_12' | translate}}</span>

        <mat-radio-group class="basic-options"
            formControlName="isSexualViolence">
            <mat-radio-button *ngFor="let opt of basicOptions" [value]="opt.value">
                {{opt.text}}
            </mat-radio-button>
        </mat-radio-group>

        <div *ngIf="isSexualViolence" class="column aside">
            <span>{{'ambulatoria.paciente.violence-situations.dialog.implemented-actions.questions.QUESTION_13' | translate}}</span>

            <mat-checkbox *ngFor="let opt of implementedActions" (click)="setImplementedActions(opt)">
                {{opt}}
            </mat-checkbox>
        </div>

    </form>

</app-new-consultation-expansion-section>
