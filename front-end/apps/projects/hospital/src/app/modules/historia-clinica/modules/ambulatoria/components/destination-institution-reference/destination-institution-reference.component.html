<h2 class="subtitle">
	{{'ambulatoria.paciente.nueva-consulta.reference-dialog.RECEIVER' | translate}}
</h2>
<div class="typeahead-field">
	<app-typeahead id="departmentDestination" [disabled]="departmentDisable" [options]="departments"
		[externalSetValue]="defaultDepartment"
		[titleInput]="'ambulatoria.paciente.nueva-consulta.reference-dialog.DEPARTMENT' | translate"
		(selectionChange)="onDepartmentSelectionChange($event)">
	</app-typeahead>
	<mat-error class="error-message" *ngIf="!departmentId && submitForm" [translate]="'forms.REQUIRED'"></mat-error>
</div>

<div class="typeahead-field">
	<app-typeahead id="institutionDestination" [disabled]="institutionsDisable" [options]="institutions"
		[externalSetValue]="defaultInstitution"
		[titleInput]="'ambulatoria.paciente.nueva-consulta.reference-dialog.PLACEHOLDER_INSTITUTION' | translate"
		(selectionChange)="onInstitutionSelectionChange($event)" [required]=true spellcheck="false">
	</app-typeahead>
	<mat-error class="error-message" *ngIf="!institutionDestinationId && submitForm"
		[translate]="'forms.REQUIRED'"></mat-error>
</div>

<ng-container *ngIf="institutionSelection && formReference.value.consultation">
	<ul>
		<ng-container *ngIf="(protectedAppointment$ | async) > 0; else NOT_AVAILABLE_APPOINTMENT">
			<span class="message" [innerHTML]="
			'ambulatoria.paciente.nueva-consulta.reference-dialog.AVAILABLE_APPOINTMENT' |
			translate: { appointment: protectedAppointment$ | async }"></span>
		</ng-container>

		<ng-container *ngIf="appointment$ | async as appointment">
			<li [ngClass]="appointment > 0? 'message' : 'message-warning'">
				<ng-container *ngIf="appointment > 0; else notAvailableAppointment">
					<span class="message">{{appointment}} {{'ambulatoria.paciente.nueva-consulta.reference-dialog.APPOINTMENT' | translate}}</span>
				</ng-container>
			</li>
		</ng-container>

		<ng-template #NOT_AVAILABLE_APPOINTMENT>
			<span class="message-warning"
				[innerHTML]="'ambulatoria.paciente.nueva-consulta.reference-dialog.NOT_AVAILABLE_APPOINTMENT' | translate"></span>
		</ng-template>

		<ng-template #notAvailableAppointment>
			<span class="message-warning">{{ZERO}} {{'ambulatoria.paciente.nueva-consulta.reference-dialog.APPOINTMENT' | translate}}</span>
		</ng-template>
	</ul>
</ng-container>
