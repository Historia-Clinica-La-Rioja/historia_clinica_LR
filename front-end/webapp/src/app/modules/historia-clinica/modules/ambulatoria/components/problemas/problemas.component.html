<app-content width="full">
	<section id="title">
		<h2 class="mat-h2" [translate]="'ambulatoria.paciente.problemas.TITLE'"></h2>
	</section>

	<ng-template #noInfo>
		<app-no-data></app-no-data>
	</ng-template>
	<section id="problemas" fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="20px">
			<div fxFlex="25%">
				<app-summary-card id="active_problems" [header]="activos" [editable]="false">
					<mat-list id="lista-problemas-activos" *ngIf="(activeProblems$ | async )?.length > 0 else noInfo">
						<div fxLayout="row" *ngFor="let problem of (activeProblems$ | async)">
							<mat-list-item>
								<span mat-line class="capitalize-first-letter">
									{{ problem.snomed.pt }}
								</span>
								<span mat-line class="mat-body">
									{{problem.startDate }}
								</span>

									<button *hasRole="['ESPECIALISTA_MEDICO', 'PROFESIONAL_DE_SALUD']" mat-icon-button [matMenuTriggerFor]="menu" >
										<mat-icon>more_vert</mat-icon>
									</button>
									<mat-menu #menu="matMenu">
										<button *ngIf="hasConfirmedAppointment" mat-menu-item (click)="goToNuevaConsulta(problem)">
											<span [translate]="'ambulatoria.paciente.nueva-consulta.TITLE_MENU'"></span>
										</button>
										<button mat-menu-item (click)="solveProblemPopUp(problem)">
											<span [translate]="'ambulatoria.paciente.problemas.END'"></span>
										</button>
									</mat-menu>

							</mat-list-item>
							<mat-divider></mat-divider>
						</div>
					</mat-list>
				</app-summary-card>
			</div>
			<div fxFlex="25%">
				<app-summary-card id="chronic_problems" [header]="cronicos" [editable]="false">
					<mat-list id="lista-problemas-cronicos" *ngIf="(chronicProblems$ | async)?.length > 0 else noInfo">
						<div fxLayout="row" *ngFor="let problem of (chronicProblems$ | async)">
							<mat-list-item>
								<span mat-line class="capitalize-first-letter">
									{{ problem.snomed.pt}}
								</span>
								<span mat-line class="mat-body">
									{{problem.startDate }}
								</span>

								<button *hasRole="['ESPECIALISTA_MEDICO', 'PROFESIONAL_DE_SALUD']" mat-icon-button [matMenuTriggerFor]="menu" >
									<mat-icon>more_vert</mat-icon>
								</button>
								<mat-menu #menu="matMenu">
									<button *ngIf="hasConfirmedAppointment" mat-menu-item (click)="goToNuevaConsulta(problem)">
										<span [translate]="'ambulatoria.paciente.nueva-consulta.TITLE_MENU'"></span>
									</button>
									<button mat-menu-item (click)="solveProblemPopUp(problem)">
										<span [translate]="'ambulatoria.paciente.problemas.END'"></span>
									</button>
								</mat-menu>

							</mat-list-item>
							<mat-divider></mat-divider>
						</div>
					</mat-list>
				</app-summary-card>
			</div>
			<div fxFlex="25%">
				<app-summary-card id="solved_problems" [header]="resueltos" [editable]="false">
					<mat-list id="lista-problemas-resueltos" *ngIf="(solvedProblems$ | async)?.length > 0 else noInfo">
						<div fxLayout="row" *ngFor="let problem of (solvedProblems$ | async)">
							<mat-list-item>
								<span mat-line class="capitalize-first-letter">
									{{ problem.snomed.pt}}
								</span>
								<span mat-line class="mat-body">
									{{problem.startDate }}
								</span>
								<ng-container *ngIf="hasConfirmedAppointment">
									<mat-menu #menu="matMenu">
										<button mat-menu-item (click)="goToNuevaConsulta(problem)">
											<span [translate]="'ambulatoria.paciente.nueva-consulta.TITLE_MENU'"> </span>
										</button>
										<button mat-menu-item (click)="goToNuevaConsulta(problem)">
											<span [translate]="'ambulatoria.paciente.problemas.END'"></span>
										</button>
									</mat-menu>
								</ng-container>
							</mat-list-item>
							<mat-divider></mat-divider>
						</div>
					</mat-list>
				</app-summary-card>
			</div>
			<div fxFlex="25%">
				<app-summary-card id="hospitalization_problems" [header]="internacion" [editable]="false">
					<mat-list id="lista-problemas-hospitalization" *ngIf="(hospitalizationProblems$ | async)?.length > 0 else noInfo">
						<div fxLayout="row" *ngFor="let problem of (hospitalizationProblems$ | async)">
							<mat-list-item>
								<span mat-line class="capitalize-first-letter">
									{{ problem.mainDiagnose.snomed.pt }}
								</span>
								<span mat-line class="mat-body">
									{{ problem.entryDate }} - {{ problem.dischargeDate? problem.dischargeDate : "actualmente internado" }}
								</span>
							</mat-list-item>
							<mat-divider></mat-divider>
						</div>
					</mat-list>
				</app-summary-card>
			</div>
	</section>
</app-content>

