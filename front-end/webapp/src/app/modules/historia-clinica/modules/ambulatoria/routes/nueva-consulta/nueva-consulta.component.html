<app-content width="full">

	<section id="header">
		<h2 id="page-title" class="page-title" [translate]="'ambulatoria.paciente.nueva-consulta.TITLE'"></h2>
		<h3 id="page_subtitle" [translate]="'ambulatoria.paciente.nueva-consulta.SUBTITLE'"></h3>
	</section>

	<section id="motivo" class="doc-section">
		<app-document-section [sectionTitle]="'ambulatoria.paciente.nueva-consulta.motivo.TITLE'">
			<ng-container concept-form>
				<app-concepts-search *ngIf="!motivoNuevaConsultaService.getMotivoConsulta() else mainMotivoConsulta"
					[label]="'ambulatoria.paciente.nueva-consulta.motivo.MOTIVO'"
					(search)="motivoNuevaConsultaService.openSearchDialog($event)">
				</app-concepts-search>

				<ng-template #mainMotivoConsulta>
					<form [formGroup]="motivoNuevaConsultaService.getForm()">
						<mat-form-field appearance="outline">
							<mat-label [translate]="'internaciones.anamnesis.diagnosticos.DIAGNOSIS'">
							</mat-label>
							<input id="motivo-input" matInput type="text" formControlName="snomed" name="snomed"
								readonly matTooltip="{{motivoNuevaConsultaService.getMotivoConsulta().snomed.pt }}">
							<button id="clear-motivo" mat-button matSuffix color="warn" mat-icon-button
								(click)="motivoNuevaConsultaService.resetForm()">
								<mat-icon>close</mat-icon>
							</button>
						</mat-form-field>
					</form>
				</ng-template>
			</ng-container>
		</app-document-section>
	</section>

	<section id="problemas" class="doc-section">
		<app-document-section [sectionTitle]="'ambulatoria.paciente.nueva-consulta.problemas.TITLE'"
			[tableTitle]="'ambulatoria.paciente.nueva-consulta.problemas.TABLE_TITLE'"
			[columns]="problemasNuevaConsultaService.getColumns()" [data]="problemasNuevaConsultaService.getProblemas()">
			<div concept-form>
				<app-concepts-search *ngIf="!problemasNuevaConsultaService.getSnomedConcept() else problemaForm"
					[label]="'ambulatoria.paciente.nueva-consulta.problemas.CONCEPT_LABEL'"
					(search)="problemasNuevaConsultaService.openSearchDialog($event)">
				</app-concepts-search>
			</div>

			<ng-template #problemaForm>
				<form [formGroup]="problemasNuevaConsultaService.getForm()"
					(ngSubmit)="problemasNuevaConsultaService.addToList()">

					<mat-form-field appearance="outline">
						<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.problemas.CONCEPT_LABEL'">
						</mat-label>
						<input id="snomed-input" matInput type="text" formControlName="snomed" name="snomed" readonly
							matTooltip="{{ problemasNuevaConsultaService.getSnomedConcept().pt }}">
						<button id="clear" mat-button matSuffix color="warn" mat-icon-button
							(click)="problemasNuevaConsultaService.resetForm()">
							<mat-icon>close</mat-icon>
						</button>
					</mat-form-field>

					<div class="margin-checkbox">
						<mat-checkbox id="cronico-checkbox" formControlName="cronico">
							<span [translate]="'ambulatoria.paciente.nueva-consulta.problemas.CRONICO'"></span>
						</mat-checkbox>
					</div>

					<mat-form-field appearance="outline">
						<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.problemas.FECHA_INICIO'">
						</mat-label>
						<input matInput id="fecha_inicio" [matDatepicker]="inicioDatePicker"
							formControlName="fechaInicio" [max]="problemasNuevaConsultaService.getFechaInicioMax()">
						<mat-datepicker-toggle matSuffix [for]="inicioDatePicker"></mat-datepicker-toggle>
						<mat-datepicker #inicioDatePicker></mat-datepicker>
					</mat-form-field>

					<mat-form-field appearance="outline">
						<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.problemas.FECHA_FIN'">
						</mat-label>
						<input matInput id="fecha_fin" [matDatepicker]="finDatePicker" formControlName="fechaFin"
							[min]="problemasNuevaConsultaService.getFechaFinMin()">
						<mat-datepicker-toggle matSuffix [for]="finDatePicker"></mat-datepicker-toggle>
						<mat-datepicker #finDatePicker></mat-datepicker>
					</mat-form-field>

					<div align="end">
						<button id="submit_problema" class="uppercase" mat-raised-button color="primary" type="submit">
							<span [translate]="'ambulatoria.paciente.nueva-consulta.problemas.buttons.ADD'"></span>
						</button>
					</div>

				</form>
			</ng-template>
		</app-document-section>
	</section>

	<section id="datos-antropometricos" class="doc-section">
		<app-document-section [sectionTitle]="'ambulatoria.paciente.nueva-consulta.datos-antropometricos.TITLE'">
			<ng-container concept-form>
				<form [formGroup]="datosAntropometricosNuevaConsultaService.getForm()">
					<div>
						<mat-form-field [floatLabel]="'never'" appearance="outline">
							<mat-label [translate]="'internaciones.anamnesis.datos-antropometricos.BLOOD_TYPE'">
							</mat-label>
							<mat-select placeholder="B+" formControlName="bloodType" name="bloodTypeId">
								<mat-option *ngFor="let bloodType of datosAntropometricosNuevaConsultaService?.getBloodTypes()" [value]="bloodType">
									{{ bloodType.description }}
								</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
					<div>
						<mat-form-field [floatLabel]="'never'" appearance="outline">
							<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.datos-antropometricos.HEIGHT'"></mat-label>
							<input id="height" name="height" formControlName="height" placeholder="Ej: 180"
								   type="number" matInput>
						</mat-form-field>
					</div>
					<div>
						<mat-form-field [floatLabel]="'never'" appearance="outline">
							<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.datos-antropometricos.WEIGHT'"></mat-label>
							<input id="weight" name="weight" formControlName="weight" placeholder="Ej: 70" type="number"
								   matInput>
						</mat-form-field>
					</div>
				</form>
			</ng-container>
		</app-document-section>
	</section>

	<section id="antecedentes-familiares" class="doc-section">
		<app-document-section [sectionTitle]="'ambulatoria.paciente.nueva-consulta.antecedentes-familiares.TITLE'"
			[tableTitle]="'ambulatoria.paciente.nueva-consulta.antecedentes-familiares.table.TITLE'"
			[columns]="antecedentesFamiliaresNuevaConsultaService.getColumns()"
			[data]="antecedentesFamiliaresNuevaConsultaService.getAntecedentesFamiliares()">
			<ng-container concept-form>
				<app-concepts-search
					*ngIf="!antecedentesFamiliaresNuevaConsultaService.getSnomedConcept() else antecedentesPersonalesForm"
					[label]="'ambulatoria.paciente.nueva-consulta.antecedentes-familiares.ANTECEDENTES_FAMILIARES'"
					(search)="antecedentesFamiliaresNuevaConsultaService.openSearchDialog($event)">
				</app-concepts-search>
				<ng-template #antecedentesPersonalesForm>
					<form [formGroup]="antecedentesFamiliaresNuevaConsultaService.getForm()"
						(ngSubmit)="antecedentesFamiliaresNuevaConsultaService.addToList()">

						<mat-form-field appearance="outline">
							<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.antecedentes-familiares.ANTECEDENTES_FAMILIARES'">
							</mat-label>
							<input id="antecedentes-familiares-input" matInput type="text" formControlName="snomed" name="snomed"
								readonly matTooltip="{{antecedentesFamiliaresNuevaConsultaService.getSnomedConcept().pt }}">
							<button id="clear-antecedente" mat-button matSuffix color="warn" mat-icon-button
								(click)="antecedentesFamiliaresNuevaConsultaService.resetForm()">
								<mat-icon>close</mat-icon>
							</button>
						</mat-form-field>

						<mat-form-field appearance="outline">
							<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.antecedentes-familiares.FECHA'">
							</mat-label>
							<input matInput id="fecha_antecedente" [matDatepicker]="antecedenteDatePicker"
								   formControlName="fecha" [max]="antecedentesFamiliaresNuevaConsultaService.getMaxFecha()">
							<mat-datepicker-toggle matSuffix [for]="antecedenteDatePicker"></mat-datepicker-toggle>
							<mat-datepicker #antecedenteDatePicker></mat-datepicker>
						</mat-form-field>

						<div align="end">
							<button id="submit_antecedentes_familiares" class="uppercase" mat-raised-button color="primary"
								type="submit">
								<span class="uppercase" [translate]="'ambulatoria.paciente.nueva-consulta.antecedentes-familiares.buttons.ADD'"></span>
							</button>
						</div>
					</form>
				</ng-template>
			</ng-container>
		</app-document-section>
	</section>

	<section id="medicaciones" class="doc-section">
		<app-document-section
			[sectionTitle]="'ambulatoria.paciente.nueva-consulta.medicaciones.TITLE'"
			[tableTitle]="'ambulatoria.paciente.nueva-consulta.medicaciones.TABLE_TITLE'"
			[columns]="medicacionesNuevaConsultaService.getColumns()"
			[data]="medicacionesNuevaConsultaService.getMedicaciones()">
				<div concept-form>
					<app-concepts-search
						*ngIf="!medicacionesNuevaConsultaService.getSnomedConcept() else medicacionForm"
						[label]="'ambulatoria.paciente.nueva-consulta.medicaciones.CONCEPT_LABEL'"
						(search)="medicacionesNuevaConsultaService.openSearchDialog($event)">
					</app-concepts-search>
				</div>

			<ng-template #medicacionForm>
				<form [formGroup]="medicacionesNuevaConsultaService.getForm()"
					  (ngSubmit)="medicacionesNuevaConsultaService.addToList()">
					<mat-form-field appearance="outline">
						<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.medicaciones.NOMBRE_MEDICACION'">
						</mat-label>
						<input matInput type="text" formControlName="snomed" name="snomed" readonly
							   matTooltip="{{ medicacionesNuevaConsultaService.getSnomedConcept().pt }}">
						<button id="clear_medicacion" mat-button matSuffix color="warn" mat-icon-button
								(click)="medicacionesNuevaConsultaService.resetForm()">
							<mat-icon>close</mat-icon>
						</button>
					</mat-form-field>

					<mat-form-field appearance="outline">
						<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.medicaciones.OBSERVACIONES'"></mat-label>
						<textarea matInput type="text" id="observaciones" name="observaciones" formControlName="observaciones"
								  placeholder="{{'ambulatoria.paciente.nueva-consulta.medicaciones.DESCRIPCION' | translate }}">
						</textarea>
					</mat-form-field>

					<div class="margin-checkbox">
						<mat-checkbox formControlName="suspendido">
							<span [translate]="'ambulatoria.paciente.nueva-consulta.medicaciones.SUSPENDIDO'"></span>
						</mat-checkbox>
					</div>

					<div align="end">
						<button class="uppercase" mat-raised-button color="primary" type="submit">
							<span [translate]="'internaciones.anamnesis.medicacion.ADD'"></span>
						</button>
					</div>
				</form>
			</ng-template>
		</app-document-section>
	</section>

	<section id="procedimientos" class="doc-section">
		<app-document-section [sectionTitle]="'ambulatoria.paciente.nueva-consulta.procedimientos.TITLE'"
			[tableTitle]="'ambulatoria.paciente.nueva-consulta.procedimientos.TABLE_TITLE'"
			[columns]="procedimientoNuevaConsultaService.getColumns()"
			[data]="procedimientoNuevaConsultaService.getProcedimientos()">
			<ng-container concept-form>
				<app-concepts-search
					*ngIf="!procedimientoNuevaConsultaService.getSnomedConcept() else procedimientoForm"
					[label]="'ambulatoria.paciente.nueva-consulta.procedimientos.PROCEDIMIENTO'"
					(search)="procedimientoNuevaConsultaService.openSearchDialog($event)">
				</app-concepts-search>

				<ng-template #procedimientoForm>
					<form [formGroup]="procedimientoNuevaConsultaService.getForm()"
						(ngSubmit)="procedimientoNuevaConsultaService.addToList()">
						<mat-form-field appearance="outline">
							<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.procedimientos.TIPO'">
							</mat-label>
							<input id="procedimiento-input" matInput type="text" formControlName="snomed" name="snomed"
								readonly matTooltip="{{procedimientoNuevaConsultaService.getSnomedConcept().pt }}">
							<button id="clear-procedimiento" mat-button matSuffix color="warn" mat-icon-button
								(click)="procedimientoNuevaConsultaService.resetForm()">
								<mat-icon>close</mat-icon>
							</button>
						</mat-form-field>

						<mat-form-field appearance="outline">
							<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.procedimientos.FECHA'">
							</mat-label>
							<input matInput id="fecha_procedimiento" [matDatepicker]="datePicker"
								formControlName="fecha" [max]="procedimientoNuevaConsultaService.getFechaMax()">
							<mat-datepicker-toggle matSuffix [for]="datePicker"></mat-datepicker-toggle>
							<mat-datepicker #datePicker></mat-datepicker>
						</mat-form-field>

						<div align="end">
							<button id="submit_procedimiento" class="uppercase" mat-raised-button color="primary"
								type="submit">
								<span
									[translate]="'ambulatoria.paciente.nueva-consulta.procedimientos.buttons.ADD'"></span>
							</button>
						</div>

					</form>
				</ng-template>
			</ng-container>
		</app-document-section>
	</section>

	<section id="signos-vitales" class="doc-section">
		<app-document-section [sectionTitle]="'ambulatoria.paciente.nueva-consulta.signos-vitales.TITLE'">
			<ng-container concept-form>
				<form [formGroup]="signosVitalesNuevaConsultaService.getForm()">
					<div fxLayout=row>
						<div class="signos-vitales-field" formGroupName="heartRate">
							<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.signos-vitales.HEART_RATE'"></mat-label>
							<mat-form-field [floatLabel]="'never'" appearance="outline">
								<input id="heart_rate"
									   name="heart_rate"
									   formControlName="value"
									   placeholder="00"
									   type="number"
									   matInput>
							</mat-form-field>
							<app-effective-time
								[model]="signosVitalesNuevaConsultaService.getForm().value.heartRate.effectiveTime"
								(onChange)="signosVitalesNuevaConsultaService.setVitalSignEffectiveTime($event, 'heartRate')">
							</app-effective-time>
						</div>
						<div class="signos-vitales-field" formGroupName="respiratoryRate">
							<mat-label
								[translate]="'ambulatoria.paciente.nueva-consulta.signos-vitales.RESPIRATORY_RATE'"></mat-label>
							<mat-form-field [floatLabel]="'never'" appearance="outline">
								<input id="respiratory_rate"
									   name="respiratory_rate"
									   formControlName="value"
									   placeholder="00"
									   type="number"
									   matInput>
							</mat-form-field>
							<app-effective-time
								[model]="signosVitalesNuevaConsultaService.getForm().value.respiratoryRate.effectiveTime"
								(onChange)="signosVitalesNuevaConsultaService.setVitalSignEffectiveTime($event, 'respiratoryRate')">
							</app-effective-time>
						</div>
					</div>

					<div fxLayout=row>
						<div class="signos-vitales-field" formGroupName="temperature">
							<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.signos-vitales.TEMPERATURE'"></mat-label>
							<mat-form-field [floatLabel]="'never'" appearance="outline">
								<input id="temperature"
									   name="temperature"
									   formControlName="value"
									   placeholder="00.0"
									   type="number"
									   matInput>
							</mat-form-field>
							<app-effective-time
								[model]="signosVitalesNuevaConsultaService.getForm().value.temperature.effectiveTime"
								(onChange)="signosVitalesNuevaConsultaService.setVitalSignEffectiveTime($event, 'temperature')">
							</app-effective-time>
						</div>
						<div class="signos-vitales-field" formGroupName="bloodOxygenSaturation">
							<mat-label
								[translate]="'ambulatoria.paciente.nueva-consulta.signos-vitales.BLOOD_OXYGEN_SATURATION'"></mat-label>
							<mat-form-field [floatLabel]="'never'" appearance="outline">
								<input id="blood_oxygen_saturation"
									   name="blood_oxygen_saturation"
									   formControlName="value"
									   placeholder="00"
									   type="number"
									   matInput>
							</mat-form-field>
							<app-effective-time
								[model]="signosVitalesNuevaConsultaService.getForm().value.bloodOxygenSaturation.effectiveTime"
								(onChange)="signosVitalesNuevaConsultaService.setVitalSignEffectiveTime($event, 'bloodOxygenSaturation')">
							</app-effective-time>
						</div>
					</div>

					<div fxLayout=row>
						<div class="signos-vitales-field" formGroupName="systolicBloodPressure">
							<mat-label
								[translate]="'ambulatoria.paciente.nueva-consulta.signos-vitales.SYSTOLIC_BLOOD_PRESSURE'"></mat-label>
							<mat-form-field [floatLabel]="'never'" appearance="outline">
								<input id="systolic_blood_pressure"
									   name="systolicBloodPressure"
									   formControlName="value"
									   placeholder="00"
									   type="number"
									   matInput>
							</mat-form-field>
							<app-effective-time
								[model]="signosVitalesNuevaConsultaService.getForm().value.systolicBloodPressure.effectiveTime"
								(onChange)="signosVitalesNuevaConsultaService.setVitalSignEffectiveTime($event, 'systolicBloodPressure')">
							</app-effective-time>
						</div>
						<div class="signos-vitales-field" formGroupName="diastolicBloodPressure">
							<mat-label
								[translate]="'ambulatoria.paciente.nueva-consulta.signos-vitales.DIASTOLIC_BLOOD_PRESSURE'"></mat-label>
							<mat-form-field [floatLabel]="'never'" appearance="outline">
								<input id="diastolic_blood_pressure"
									   name="diastolicBloodPressure"
									   formControlName="value"
									   placeholder="00"
									   type="number"
									   matInput>
							</mat-form-field>
							<app-effective-time
								[model]="signosVitalesNuevaConsultaService.getForm().value.diastolicBloodPressure.effectiveTime"
								(onChange)="signosVitalesNuevaConsultaService.setVitalSignEffectiveTime($event, 'diastolicBloodPressure')">
							</app-effective-time>
						</div>
					</div>
				</form>
			</ng-container>
		</app-document-section>
	</section>

	<section id="alergias" class="doc-section">
		<app-document-section [sectionTitle]="'ambulatoria.paciente.nueva-consulta.alergias.TITLE'"
			[tableTitle]="'ambulatoria.paciente.nueva-consulta.alergias.table.TITLE'"
			[columns]="alergiasNuevaConsultaService.getColumns()"
			[data]="alergiasNuevaConsultaService.getAlergias()">
			<ng-container concept-form>
				<app-concepts-search
					*ngIf="!alergiasNuevaConsultaService.getSnomedConcept() else alergiasForm"
					[label]="'ambulatoria.paciente.nueva-consulta.alergias.ALLERGY'"
					(search)="alergiasNuevaConsultaService.openSearchDialog($event)">
				</app-concepts-search>
				<ng-template #alergiasForm>
					<form [formGroup]="alergiasNuevaConsultaService.getForm()"
						(ngSubmit)="alergiasNuevaConsultaService.addToList()">
						<mat-form-field appearance="outline">
							<mat-label [translate]="'ambulatoria.paciente.nueva-consulta.alergias.ALLERGY'">
							</mat-label>
							<input id="alergias-input" matInput type="text" formControlName="snomed" name="snomed"
								readonly matTooltip="{{alergiasNuevaConsultaService.getSnomedConcept().pt }}">
							<button id="clear-alergias" mat-button matSuffix color="warn" mat-icon-button
								(click)="alergiasNuevaConsultaService.resetForm()">
								<mat-icon>close</mat-icon>
							</button>
						</mat-form-field>
						<div align="end">
							<button id="submit_alergias" class="uppercase" mat-raised-button color="primary"
								type="submit">
								<span class="uppercase" [translate]="'ambulatoria.paciente.nueva-consulta.alergias.ADD'"></span>
							</button>
						</div>
					</form>
				</ng-template>
			</ng-container>
		</app-document-section>
	</section>

	<section id="evolucion" class="doc-section">
		<app-document-section [sectionTitle]="'ambulatoria.paciente.nueva-consulta.evolucion.TITLE'">
			<ng-container concept-form>
				<form [formGroup]="formEvolucion">
					<mat-form-field appearance="outline">
						<textarea matInput type="text" id="evolucion-input" name="evolucion" formControlName="evolucion"
								  placeholder="{{'ambulatoria.paciente.nueva-consulta.evolucion.DESCRIPCION' | translate }}">
						</textarea>
					</mat-form-field>
				</form>
			</ng-container>
		</app-document-section>
	</section>

	<section class="doc-section">
		<div align="end">
			<button class="uppercase" mat-raised-button color="primary" (click)="save()">
				<span [translate]="'buttons.CONFIRM'"></span>
			</button>
		</div>
	</section>

</app-content>
