<app-summary-card [header]="documentsSummary">
	<ng-container *ngIf="this.documentHistoric?.documents.length !== 0 || searchTriggered; else noData">
		<div class="search-form" id="header">
			<form fxLayout="row" fxLayoutGap="10px" id="document-search-form" [formGroup]="form" (ngSubmit)="search()">
				<div style="width: 35%">
					<div style="padding-left: 16px;">
						<mat-form-field class="input" appearance="outline"
										*ngIf="form.value.field === 'CREATED_ON'; else textInput">
							<mat-label>Fecha</mat-label>
							<input matInput
								   id="date"
								   formControlName="date"
								   [matDatepicker]="myDatepicker"
								   [max]="this.today">
							<mat-datepicker-toggle matSuffix [for]="myDatepicker"></mat-datepicker-toggle>
							<mat-datepicker #myDatepicker></mat-datepicker>
							<mat-error>La fecha ingresada no es válida</mat-error>
						</mat-form-field>

						<ng-template #textInput>
							<mat-form-field class="input" appearance="outline">
								<mat-label>Filtro</mat-label>
								<input matInput
									   id="filter"
									   name="text"
									   formControlName="text"
									   type="text">
							</mat-form-field>
						</ng-template>
					</div>
				</div>

				<mat-form-field appearance="outline">
					<mat-label>Campo</mat-label>
					<mat-select formControlName="field" name="field">
						<mat-option *ngFor="let field of searchFields" [value]="field.field">
							{{field.label | translate}}
						</mat-option>
					</mat-select>
				</mat-form-field>
				<div *featureFlag="'habilitarToggleFiltroDiagnosticoPrincipal'" class="main-diagnosis-toggle">
					<mat-label>Diagnóstico principal</mat-label>
					<mat-slide-toggle formControlName="mainDiagnosisOnly" (change)="updateDocuments()">
					</mat-slide-toggle>
				</div>
			</form>
		</div>
		<div class="documents" id="documents" fxLayout="row">
			<mat-selection-list color="accent" [multiple]=false>
				<mat-list-option (click)="setActive(document)"
								 *ngFor="let document of documentsToShow">
					<span id="main-diagnosis" mat-line class="capitalize-first-letter" *ngIf="document.mainDiagnosis">
						{{document.mainDiagnosis}}
					</span>
					<span *ngIf="document.diagnosis.length && !document.mainDiagnosis" mat-line></span>
					<span id="other-diagnosis" *ngFor="let diagnosis of document.diagnosis"
						  mat-line class="capitalize-first-letter">
						{{diagnosis}}
					</span>
					<mat-icon mat-list-icon fontSet="material-icons-outlined" color="primary">assignment</mat-icon>
					<span mat-line>{{document.createdOn | date : 'dd/MM/yyyy'}}</span>
					<span mat-line>{{document.creator.firstName}} {{document.creator.lastName}}</span>
					<mat-divider></mat-divider>

				</mat-list-option>
			</mat-selection-list>
			<div *ngIf="activeDocument?.notes" class="content">

				<section *ngIf="activeDocument.notes.currentIllnessNote">
					<div class="mat-body" [translate]="'internaciones.anamnesis.observations.CURRENT_DISEASE'"></div>
					<div class="mat-body-strong">{{activeDocument.notes.currentIllnessNote}}</div>
				</section>

				<section *ngIf="activeDocument.notes.physicalExamNote">
					<div class="mat-body"
						 [translate]="'internaciones.anamnesis.observations.PHYSICAL_EXAMINATION'"></div>
					<div class="mat-body-strong">{{activeDocument.notes.physicalExamNote}}</div>
				</section>

				<section *ngIf="activeDocument.notes.studiesSummaryNote">
					<div class="mat-body" [translate]="'internaciones.anamnesis.observations.STUDIES_PROCEDURES'"></div>
					<div class="mat-body-strong">{{activeDocument.notes.studiesSummaryNote}}</div>
				</section>

				<section *ngIf="activeDocument.notes.evolutionNote">
					<div class="mat-body" [translate]="'internaciones.anamnesis.observations.PATIENT_PROGRESS'"></div>
					<div class="mat-body-strong">{{activeDocument.notes.evolutionNote}}</div>
				</section>

				<section *ngIf="activeDocument.notes.clinicalImpressionNote">
					<div class="mat-body"
						 [translate]="'internaciones.anamnesis.observations.CLINICAL_IMPRESSION'"></div>
					<div class="mat-body-strong">{{activeDocument.notes.clinicalImpressionNote}}</div>
				</section>

				<section *ngIf="activeDocument.notes.indicationsNote">
					<div class="mat-body" [translate]="'internaciones.epicrisis.observations.INDICATIONS_NOTE'"></div>
					<div class="mat-body-strong">{{activeDocument.notes.indicationsNote}}</div>
				</section>

				<section *ngIf="activeDocument.notes.otherNote">
					<div class="mat-body" [translate]="'internaciones.anamnesis.observations.OTHERS'"></div>
					<div class="mat-body-strong">{{activeDocument.notes.otherNote}}</div>
				</section>
			</div>

			<div *ngIf="(activeDocument && !activeDocument.notes)" class="no-notes content mat-body-strong">
				No hay observaciones para mostrar
			</div>
		</div>
	</ng-container>

	<ng-template #noData>
		<app-no-data></app-no-data>
	</ng-template>
</app-summary-card>
