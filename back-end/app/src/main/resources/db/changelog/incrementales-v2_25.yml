databaseChangeLog: 
    - logicalFilePath: incrementales-v2_25

    - changeSet:
        id: addColumn_closest_service
        author: lmanterola
        changes:
          - addColumn:
              tableName: hierarchical_unit
              columns:
                - column:
                    name: closest_service_id
                    type: int
          - addForeignKeyConstraint:
              baseColumnNames: closest_service_id
              baseTableName: hierarchical_unit
              constraintName: FK_closest_service_id
              onDelete: NO ACTION
              onUpdate: NO ACTION
              referencedColumnNames: id
              referencedTableName: hierarchical_unit
              validate: true

    - changeSet:
        id: role-api_anexo-level-change
        context: "!schema-only"
        author: efernandez
        changes:
          - sql:
              sql: |-
                UPDATE user_role SET institution_id = -1 WHERE role_id = 47;

    - changeSet:
        id: add-column-local_viewer_url-to-pac_server_image_lvl
        author: fzudaire
        changes:
            - addColumn:
                tableName: pac_server_image_lvl
                columns:
                    - column:
                        name: local_viewer_url
                        type: varchar(128)
                        constraints:
                            nullable: true
        
    - changeSet:
        id: createTable-institution_responsibility_area
        comment: Create table institution_responsibility_area
        author: mmalyvarni
        changes:
          - createTable:
              tableName: institution_responsibility_area
              columns:
                - column:
                    name: institution_id
                    type: int
                    constraints:
                      nullable: false
                      foreignKeyName: FK_institution_responsibility_area_institution_id
                      references: institution(id)
                - column:
                    name: order_id
                    type: smallint
                    constraints:
                      nullable: false
                - column:
                    name: latitude
                    type: float
                    constraints:
                      nullable: false
                - column:
                    name: longitude
                    type: float
                    constraints:
                      nullable: false
          - addPrimaryKey:
              clustered: true
              columnNames: institution_id, order_id
              constraintName: PK_institution_responsibility_area
              tableName: institution_responsibility_area
              validate: true
