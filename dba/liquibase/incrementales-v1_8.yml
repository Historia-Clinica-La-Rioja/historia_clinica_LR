databaseChangeLog: 
    - logicalFilePath: incrementales-v1_8 

    - changeSet:
        id: addAutoIncrement-triage
        author: tmedina
        changes:
            - addAutoIncrement:
                columnDataType: int  
                columnName: id  
                generationType: ALWAYS  
                incrementBy: 1  
                startWith: 1 
                tableName: triage

    - changeSet:
        id: addAutoIncrement-emergency_care_episode
        author: tmedina
        changes:
            - addAutoIncrement:
                columnDataType: int  
                columnName: id  
                generationType: ALWAYS  
                incrementBy: 1  
                startWith: 1 
                tableName: emergency_care_episode

    - changeSet:
        id: addAutoIncrement-police_intervention
        author: tmedina
        changes:
            - addAutoIncrement:
                columnDataType: int  
                columnName: id  
                generationType: ALWAYS  
                incrementBy: 1  
                startWith: 1 
                tableName: police_intervention

    - changeSet:
        id: addColumn-institution_id-emergency_care_episode
        author: tmedina
        comment: Add column institution_id to emergency_care_episode table
        changes:
            - addColumn:
                tableName: emergency_care_episode
                columns:
                - column:
                    name: institution_id
                    type: int
                    defaultValue: '-1'
                    constraints:
                        nullable: false

    - changeSet:
        id: emergency_care_episode-addForeignKeyConstraint-institution_id
        author: tmedina
        comment: Add foreign key constraint for column institution_id in emergency_care_episode to institution table
        changes:
            - addForeignKeyConstraint:
                baseColumnNames: institution_id
                baseTableName: emergency_care_episode
                constraintName: FK_emergency_care_episode_institution_id
                onDelete: NO ACTION
                onUpdate: NO ACTION
                referencedColumnNames: id
                referencedTableName: institution
                validate: true

    - changeSet:
        id: emergency_care_episode-dropNotNullConstraint-doctors_office_id
        author: tmedina
        comment: Drop not null constraint in doctors_office_id column in emergency_care_episode table
        changes:
            - dropNotNullConstraint:
                columnDataType: int
                columnName: doctors_office_id
                tableName: emergency_care_episode
                
    - changeSet:  
        id:  createTable-DiagnosticReportFile
        author: martinscooper  
        changes:  
        - createTable: 
            tableName: diagnostic_report_file  
            columns:  
            - column: 
                autoIncrement: true
                constraints:
                    primaryKey: true
                    primaryKeyName: PK_diagnostic_report_file 
                name:  id  
                type:  int 
            - column:
                constraints:
                    nullable: false
                name: path
                type: varchar
            - column:
                constraints:
                    nullable: false
                name: content_type
                type: varchar
            - column:
                constraints:
                    nullable: false
                name: size
                type: int8 
            - column:
                name: diagnostic_report_id
                type: int
                constraints:
                    nullable: true
                    references: diagnostic_report(id)
                    foreignKeyName: FK_diagnostic_report 
            - column:
                    constraints:
                        nullable: false
                    name: created_by
                    type: int
                    defaultValue: -1
            - column:
                constraints:
                    nullable: false
                name: updated_by
                type: int
                defaultValue: -1
            - column:
                constraints:
                    nullable: false
                name: created_on
                type: datetime
                defaultValueDate: ${date.now}
            - column:
                constraints:
                    nullable: false
                name: updated_on
                type: datetime
                defaultValueDate: ${date.now} 
    
    - changeSet:
        id: add-filename-diagnostic_report_file
        author: martinscooper
        changes:
            addColumn:
                tableName: diagnostic_report_file
                columns:
                - column:
                    name: name
                    type: varchar
                    constraints: 
                        nullable: false
    
    - changeSet:
        id: drop-column-path_file-diagnostic_report
        author: martinscooper
        changes:
            dropColumn:
                tableName: diagnostic_report
                columnName: path_file
